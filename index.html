
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Galer√≠a QSL por Indicativo</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="header">
    <div class="header-content">
      <img src="logo-gadtm.png" alt="Logo Izquierdo" class="logo-side">
      <h1>üîç Buscar QSL por Indicativo üì°</h1>
      <img src="logo-qrz.png" alt="Logo Derecho" class="logo-side">
      <p>Ingres√° tu indicativo para ver las QSLs:</p>
      <input type="text" id="callsignInput" placeholder="Ej: LU1ABC">
      <button onclick="cargarGaleria()">Buscar</button>
    </div>
    <div class="galeria" id="galeria"></div>
  </div>

  <script>
    async function cargarGaleria() {
      const callSign = document.getElementById("callsignInput").value.trim().toUpperCase();
      const galeria = document.getElementById("galeria");
      galeria.innerHTML = "";

      if (!callSign) {
        alert("Por favor ingres√° un indicativo.");
        return;
      }

      const url = `/.netlify/functions/buscarQSL?callSign=${callSign}`;

      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error("No se pudo acceder a la galer√≠a");
        const images = await res.json();

        if (!images.length) {
          galeria.innerHTML = `<p>No se encontraron QSLs para <strong>${callSign}</strong>.</p>`;
          return;
        }
images.forEach(img => {
  if (!img.url) return;

  // Crear enlace con descarga directa
  const link = document.createElement("a");
  link.href = img.url;
  link.download = img.public_id + "." + img.format; // nombre del archivo

  // Miniatura de la imagen en la galer√≠a
  const imgEl = document.createElement("img");
  imgEl.src = img.url;
  imgEl.alt = img.public_id;
  imgEl.style.width = "200px"; // ajusta tama√±o de preview

  // Insertar la miniatura dentro del enlace
  link.appendChild(imgEl);

  // Agregar al contenedor
  galeria.appendChild(link);
});

      } catch (error) {
        galeria.innerHTML = `<p style="color: red;">‚ùå Error al consultar im√°genes para <strong>${callSign}</strong>.</p>`;
        console.error("Error al cargar la galer√≠a:", error);
      }
    }
  </script>
</body>
</html>
